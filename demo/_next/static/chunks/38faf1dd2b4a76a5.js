(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,34883,e=>{"use strict";e.s(["default",()=>r]);var s=e.i(43476),t=e.i(71645),a=e.i(18566),n=e.i(23312);let l=(e,s)=>{switch(e){case"validate":return["âœ“ Configuration validated","âœ“ Resource quotas checked","âœ“ Dependencies resolved"];case"provision":return["â†’ Allocating compute resources","â†’ Creating network infrastructure","â†’ Configuring firewall rules","â†’ Setting up internal DNS","âœ“ Infrastructure provisioned","âœ“ Network established"];case"database":return["â†’ Creating database instance","â†’ Allocating storage","â†’ Enabling automated backups","â†’ Configuring replication","âœ“ Database ready"];case"cache":return["â†’ Deploying cache service","â†’ Configuring memory allocation","â†’ Setting up persistence","âœ“ Cache service ready"];case"loadbalancer":return["â†’ Creating load balancer","â†’ Provisioning SSL certificate","â†’ Configuring routing rules","âœ“ Load balancer active"];case"health":return["â†’ Waiting for services to start","â†’ Running health checks","â†’ Verifying SSL certificate","âœ“ All health checks passed"];case"complete":return["ðŸŽ‰ Deployment successful!"];default:if(e.startsWith("container-")){let a=e.replace("container-",""),n=s.containers.find(e=>e.id===a);if(n){var t;let e=(null==(t=n.imageUrl.split("/").pop())?void 0:t.split(":")[0])||"container",s=["â†’ Authenticating with registry","â†’ Pulling image: ".concat(n.imageUrl),"â†’ Extracting layers","â†’ Configuring DNS: ".concat(e,".internal")];return n.serviceAccess.database&&s.push("â†’ Injecting DATABASE_URL"),n.serviceAccess.cache&&s.push("â†’ Injecting CACHE_URL"),s.push("â†’ Starting ".concat(n.resources.replicas.min," replicas")),s.push("â†’ Health checks on port ".concat(n.port)),s.push("âœ“ ".concat(e," running (").concat(n.exposure,")")),s}}return[]}};function r(){let e=(0,a.useRouter)(),{state:r,getActiveEnvironment:i}=(0,n.useDeployment)(),c=i(),[o,d]=(0,t.useState)(0),[p,u]=(0,t.useState)([]),[h,m]=(0,t.useState)(0),[x,g]=(0,t.useState)(!1);if((0,t.useEffect)(()=>{window.scrollTo(0,0)},[]),(0,t.useEffect)(()=>{c&&c.containers.length>0&&u((e=>{var s,t;let a=[];return a.push({id:"validate",label:"Validating configuration",description:"Checking resources and dependencies",duration:2,status:"pending",logs:[]}),a.push({id:"provision",label:"Provisioning infrastructure",description:"Setting up servers and networking",duration:8,status:"pending",logs:[]}),(null==(s=e.resources)?void 0:s.database)&&a.push({id:"database",label:"Configuring database",description:"Setting up database instance with backups",duration:6,status:"pending",logs:[]}),(null==(t=e.resources)?void 0:t.cache)&&a.push({id:"cache",label:"Setting up cache",description:"Deploying cache service",duration:4,status:"pending",logs:[]}),e.containers.forEach((e,s)=>{var t;let n=(null==(t=e.imageUrl.split("/").pop())?void 0:t.split(":")[0])||"container-".concat(s+1);a.push({id:"container-".concat(e.id),label:"Deploying ".concat(n),description:"Pulling image and starting ".concat(e.resources.replicas.min," replicas"),duration:7,status:"pending",logs:[]})}),a.push({id:"loadbalancer",label:"Configuring load balancer",description:"Setting up SSL and routing rules",duration:4,status:"pending",logs:[]}),a.push({id:"health",label:"Running health checks",description:"Verifying all services are responding",duration:5,status:"pending",logs:[]}),a.push({id:"complete",label:"Deployment complete",description:"Your application is live!",duration:1,status:"pending",logs:[]}),a})({...r,containers:c.containers,resources:{database:c.database,cache:c.cache,replicas:{min:1,max:1},cpu:"0.5",memory:"512MB"}}))},[c]),(0,t.useEffect)(()=>{c&&0!==c.containers.length||e.push("/dashboard")},[c,e]),(0,t.useEffect)(()=>{let e;if(!c||0===p.length||x)return;let s=[],t=[],a=async()=>{let e={...r,containers:c.containers,resources:{database:c.database,cache:c.cache,replicas:{min:1,max:1},cpu:"0.5",memory:"512MB"}};for(let a=0;a<p.length;a++)await new Promise(n=>{u(e=>e.map((e,s)=>s===a?{...e,status:"running"}:s<a?{...e,status:"completed"}:e)),d(a);let r=l(p[a].id,e),i=0,c=setInterval(()=>{i<r.length&&(u(e=>e.map((e,s)=>s===a&&"running"===e.status?{...e,logs:r.slice(0,i+1)}:e)),i++)},600);t.push(c);let o=setTimeout(()=>{clearInterval(c),u(e=>e.map((e,s)=>s===a?{...e,status:"completed"}:e)),n()},1e3*p[a].duration);s.push(o)});g(!0)};return e=setInterval(()=>{m(e=>e+1)},1e3),a(),()=>{s.forEach(e=>clearTimeout(e)),t.forEach(e=>clearInterval(e)),clearInterval(e)}},[c,p.length,x]),!c||0===p.length)return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 py-12 px-4 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin text-6xl mb-4",children:"âš™ï¸"}),(0,s.jsx)("p",{className:"text-slate-600",children:"Preparing deployment..."})]})});let b=p.filter(e=>"completed"===e.status).length,f=p.length,j=b/f*100,v=p.reduce((e,s)=>e+s.duration,0);return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 py-12 px-4",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsxs)("div",{className:"inline-flex items-center gap-2 bg-purple-100 text-purple-700 px-4 py-2 rounded-full text-sm font-medium mb-4",children:[(0,s.jsx)("span",{children:"ðŸš€"}),(0,s.jsx)("span",{children:"Deployment in progress"})]}),(0,s.jsx)("h1",{className:"text-4xl font-bold text-slate-900 mb-3",children:"Deploying Your Application"}),(0,s.jsxs)("p",{className:"text-lg text-slate-600",children:[c.containers.length>1?"Deploying ".concat(c.containers.length," containers and infrastructure."):"Deploying your container and infrastructure."," This typically takes ",v,"-",v+10," seconds."]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-8 mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("span",{className:"text-3xl",children:"â±ï¸"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-slate-900",children:b===f?"Complete!":"Deploying..."}),(0,s.jsxs)("p",{className:"text-sm text-slate-600",children:[b," of ",f," steps completed"]})]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("p",{className:"text-2xl font-bold text-purple-600",children:(e=>{let s=Math.floor(e/60);return"".concat(s,":").concat((e%60).toString().padStart(2,"0"))})(h)}),(0,s.jsx)("p",{className:"text-xs text-slate-500",children:"elapsed"})]})]}),(0,s.jsx)("div",{className:"w-full bg-slate-200 rounded-full h-3 overflow-hidden",children:(0,s.jsx)("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 h-3 rounded-full transition-all duration-500 ease-out",style:{width:"".concat(j,"%")}})}),(0,s.jsxs)("p",{className:"text-right text-sm text-slate-600 mt-2",children:[Math.round(j),"%"]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-8 mb-6",children:[(0,s.jsxs)("h3",{className:"text-xl font-bold text-slate-900 mb-6 flex items-center gap-2",children:[(0,s.jsx)("span",{children:"ðŸ“‹"}),(0,s.jsx)("span",{children:"Deployment Steps"})]}),(0,s.jsx)("div",{className:"space-y-6",children:p.map((e,t)=>(0,s.jsxs)("div",{className:"relative",children:[t<p.length-1&&(0,s.jsx)("div",{className:"absolute left-[11px] top-8 w-0.5 h-full ".concat("completed"===e.status?"bg-green-600":"bg-slate-200")}),(0,s.jsxs)("div",{className:"relative flex gap-4 p-4 rounded-lg transition-all ".concat("running"===e.status?"bg-purple-50 border-2 border-purple-600":"completed"===e.status?"bg-green-50 border border-green-200":"bg-slate-50 border border-slate-200"),children:[(0,s.jsx)("div",{className:"flex-shrink-0 w-6 h-6 mt-1",children:(e=>{switch(e){case"completed":return(0,s.jsx)("span",{className:"text-green-600",children:"âœ“"});case"running":return(0,s.jsxs)("svg",{className:"animate-spin h-5 w-5 text-purple-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]});case"error":return(0,s.jsx)("span",{className:"text-red-600",children:"âœ—"});default:return(0,s.jsx)("span",{className:"text-slate-300",children:"â—‹"})}})(e.status)}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,s.jsx)("h4",{className:"font-semibold ".concat("running"===e.status?"text-purple-900":"completed"===e.status?"text-green-900":"text-slate-700"),children:e.label}),"running"===e.status&&(0,s.jsx)("span",{className:"text-xs bg-purple-600 text-white px-2 py-1 rounded-full font-medium",children:"In Progress"})]}),(0,s.jsx)("p",{className:"text-sm text-slate-600 mb-2",children:e.description}),e.logs&&e.logs.length>0&&(0,s.jsx)("div",{className:"bg-slate-900 rounded-lg p-3 font-mono text-xs mt-3",children:e.logs.map((e,t)=>(0,s.jsx)("div",{className:"text-green-400 mb-1",children:e},t))})]})]})]},e.id))})]}),(0,s.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl p-6 border border-blue-100 mb-6",children:[(0,s.jsxs)("h4",{className:"font-semibold text-slate-900 mb-3 flex items-center gap-2",children:[(0,s.jsx)("span",{children:"ðŸ’¡"}),(0,s.jsx)("span",{children:"What's happening behind the scenes"})]}),(0,s.jsxs)("ul",{className:"space-y-2 text-sm text-slate-700",children:[(0,s.jsxs)("li",{className:"flex items-start gap-2",children:[(0,s.jsx)("span",{className:"text-purple-600 mt-0.5",children:"â€¢"}),(0,s.jsx)("span",{children:"Provisioning servers in Germany"})]}),c.database&&(0,s.jsxs)("li",{className:"flex items-start gap-2",children:[(0,s.jsx)("span",{className:"text-purple-600 mt-0.5",children:"â€¢"}),(0,s.jsx)("span",{children:"Setting up database with automated backups"})]}),c.cache&&(0,s.jsxs)("li",{className:"flex items-start gap-2",children:[(0,s.jsx)("span",{className:"text-purple-600 mt-0.5",children:"â€¢"}),(0,s.jsx)("span",{children:"Deploying cache service"})]}),c.containers.map((e,t)=>{var a;let n=(null==(a=e.imageUrl.split("/").pop())?void 0:a.split(":")[0])||"container-".concat(t+1);return(0,s.jsxs)("li",{className:"flex items-start gap-2",children:[(0,s.jsx)("span",{className:"text-purple-600 mt-0.5",children:"â€¢"}),(0,s.jsxs)("span",{children:["Deploying ",(0,s.jsx)("strong",{children:n}),": ",e.resources.replicas.min,"-",e.resources.replicas.max," replicas","public"===e.exposure?" (public)":" (private)"]})]},e.id)}),(0,s.jsxs)("li",{className:"flex items-start gap-2",children:[(0,s.jsx)("span",{className:"text-purple-600 mt-0.5",children:"â€¢"}),(0,s.jsx)("span",{children:"Provisioning SSL certificate for HTTPS"})]}),(0,s.jsxs)("li",{className:"flex items-start gap-2",children:[(0,s.jsx)("span",{className:"text-purple-600 mt-0.5",children:"â€¢"}),(0,s.jsxs)("span",{children:["Deploying to: ",(0,s.jsx)("code",{className:"bg-white px-2 py-0.5 rounded text-xs",children:c.baseDomain})]})]})]})]}),x&&(0,s.jsx)("div",{className:"text-center",children:(0,s.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-xl p-8 mb-6",children:[(0,s.jsx)("div",{className:"text-5xl mb-4",children:"ðŸŽ‰"}),(0,s.jsx)("h2",{className:"text-2xl font-bold text-green-900 mb-2",children:"Deployment Complete!"}),(0,s.jsx)("p",{className:"text-green-700 mb-6",children:"Your application is now live and running"}),(0,s.jsx)("button",{onClick:()=>e.push("/dashboard?selection=environment&env=".concat(c.id)),className:"px-8 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition font-medium",children:"View Operations Dashboard â†’"})]})})]})})}}]);