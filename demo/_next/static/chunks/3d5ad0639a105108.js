(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,23312,e=>{"use strict";e.s(["DeploymentProvider",()=>a,"useDeployment",()=>i]);var t=e.i(43476),n=e.i(71645);let r=(0,n.createContext)(void 0),o={user:null,questionnaire:null,application:null,containers:[],resources:null,environment:null,domain:null,cost:null,deployed:!1,project:null,activeEnvironmentId:null,projectName:void 0,region:void 0,smartQuestionnaire:null,recommendations:null};function a(e){let{children:a}=e,[i,s]=(0,n.useState)(()=>{{let o=localStorage.getItem("unhazzle-deployment-state");if(o)try{let a=JSON.parse(o),i=a.containers||[],s=a.project;if(a.deployed&&!s&&i.length>0){var e,t,n,r;let o=new Date().toISOString(),l=(null==(e=a.questionnaire)?void 0:e.appType)?"".concat(a.questionnaire.appType.toLowerCase(),"-app"):"my-app",c=i.filter(e=>"public"===e.exposure).map(e=>e.name);s={id:"proj-"+Date.now(),name:(null==(t=a.questionnaire)?void 0:t.appType)?"".concat(a.questionnaire.appType," Application"):"My Application",slug:l,createdAt:o,updatedAt:o,prEnvs:{enabled:!0,maxEnvs:3,lifetimeHours:2,autoDeleteOnPRClose:!0},environments:[{id:"env-dev-"+Date.now(),name:"dev",slug:"dev",type:"standard",status:"active",createdAt:o,baseDomain:"dev.".concat(l,".demo.unhazzle.io"),publicContainers:c,containers:i,database:null==(n=a.resources)?void 0:n.database,cache:null==(r=a.resources)?void 0:r.cache}],envCount:1,prEnvCount:0,standardEnvCount:1}}return{...a,containers:i,project:s}}catch(e){console.error("Failed to parse saved state:",e)}}return o}),l=e=>{if(!i.project)throw Error("Cannot create environment without a project");let t=new Date().toISOString(),n=e.name.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""),r=(e.containers||[]).filter(e=>"public"===e.exposure).map(e=>e.name),o={id:"env-".concat(n,"-").concat(Date.now()),slug:n,type:e.type||"standard",status:e.status||"active",deployed:e.deployed||!1,deployedAt:e.deployedAt,pendingChanges:e.pendingChanges||!1,createdAt:t,baseDomain:"".concat(n,".").concat(i.project.slug,".demo.unhazzle.io"),publicContainers:r,containers:e.containers||[],database:e.database,cache:e.cache,...e,name:e.name};return s(e=>{if(!e.project)return e;let n=[...e.project.environments,o],r=n.filter(e=>"pr"===e.type).length,a=n.filter(e=>"standard"===e.type).length,i={...e.project,environments:n,envCount:n.length,prEnvCount:r,standardEnvCount:a,updatedAt:t},s={...e,project:i,activeEnvironmentId:o.id};return localStorage.setItem("unhazzle-deployment-state",JSON.stringify(s)),s}),o},c=(e,t)=>{s(n=>{if(!n.project)return n;let r=n.project.environments.map(n=>{if(n.id===e){let e={...n,...t};return t.containers&&(e.publicContainers=t.containers.filter(e=>"public"===e.exposure).map(e=>e.name)),e}return n}),o={...n.project,environments:r,updatedAt:new Date().toISOString()},a={...n,project:o};return localStorage.setItem("unhazzle-deployment-state",JSON.stringify(a)),a})};return(0,t.jsx)(r.Provider,{value:{state:i,updateState:e=>{s(t=>{let n={...t,...e};return localStorage.setItem("unhazzle-deployment-state",JSON.stringify(n)),n})},updateUser:e=>{s(t=>{let n={...t,user:e};return localStorage.setItem("unhazzle-deployment-state",JSON.stringify(n)),n})},updateQuestionnaire:e=>{s(t=>{let n={...t,questionnaire:e};return localStorage.setItem("unhazzle-deployment-state",JSON.stringify(n)),n})},updateApplication:e=>{s(t=>{let n={...t,application:e};return localStorage.setItem("unhazzle-deployment-state",JSON.stringify(n)),n})},addContainer:e=>{s(t=>{let n=t.containers||[],r={...t,containers:[...n,e]};return localStorage.setItem("unhazzle-deployment-state",JSON.stringify(r)),r})},clearContainers:()=>{s(e=>{let t={...e,containers:[]};return localStorage.setItem("unhazzle-deployment-state",JSON.stringify(t)),t})},updateContainer:(e,t)=>{s(n=>{var r;let o=(n.containers||[]).map(n=>n.id===e?{...n,...t}:n),a=n.project;(null==(r=n.project)?void 0:r.environments)&&(a={...n.project,environments:n.project.environments.map(n=>{if(n.containers.some(t=>t.id===e)){let r=n.containers.map(n=>n.id===e?{...n,...t}:n);return{...n,containers:r,publicContainers:t.name?n.publicContainers.map(r=>{let o=n.containers.find(t=>t.id===e);return o&&o.name===r?t.name:r}):n.publicContainers}}return n})});let i={...n,containers:o,project:a};return localStorage.setItem("unhazzle-deployment-state",JSON.stringify(i)),i})},removeContainer:(e,t)=>{s(n=>{var r;let o=(n.containers||[]).filter(t=>t.id!==e),a=n.project;(null==(r=n.project)?void 0:r.environments)&&(a={...n.project,environments:n.project.environments.map(n=>{if(t&&n.id!==t)return n;let r=n.containers||[],o=r.find(t=>t.id===e),a=r.filter(t=>t.id!==e);return{...n,containers:a,publicContainers:o?n.publicContainers.filter(e=>e!==o.name):n.publicContainers}})});let i={...n,containers:o,project:a};return localStorage.setItem("unhazzle-deployment-state",JSON.stringify(i)),i})},updateResources:e=>{s(t=>{var n,r;let o=t.project;(null==(r=t.project)||null==(n=r.environments)?void 0:n[0])&&(o={...t.project,environments:t.project.environments.map((t,n)=>0===n?{...t,database:e.database,cache:e.cache}:t)});let a={...t,resources:e,project:o};return localStorage.setItem("unhazzle-deployment-state",JSON.stringify(a)),a})},updateEnvironment:e=>{s(t=>{let n={...t,environment:e};return localStorage.setItem("unhazzle-deployment-state",JSON.stringify(n)),n})},updateDomain:e=>{s(t=>{let n={...t,domain:e};return localStorage.setItem("unhazzle-deployment-state",JSON.stringify(n)),n})},updateCost:e=>{s(t=>{let n={...t,cost:e};return localStorage.setItem("unhazzle-deployment-state",JSON.stringify(n)),n})},markDeployed:()=>{s(e=>{var t,n,r,o;let a=new Date().toISOString(),i=Date.now(),s=null==(t=e.projectName)?void 0:t.trim(),l=s&&s.length>0?s:"Project ".concat(i.toString().slice(-6)),c=s&&s.length>0?s.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""):"project-".concat(i.toString().slice(-6)),p=(e.containers||[]).filter(e=>"public"===e.exposure).map(e=>e.name),d={id:"env-dev-"+i,name:"dev",slug:"dev",type:"standard",status:"active",deployed:!0,deployedAt:a,pendingChanges:!1,createdAt:a,baseDomain:"dev.".concat(c,".demo.unhazzle.io"),publicContainers:p,containers:e.containers||[],database:null==(n=e.resources)?void 0:n.database,cache:null==(r=e.resources)?void 0:r.cache},u={id:"proj-"+i,name:l,slug:c,description:"A production-ready application deployed with Unhazzle",createdAt:a,updatedAt:a,repository:{url:"https://github.com/".concat((null==(o=e.user)?void 0:o.githubUsername)||"username","/").concat(c),branch:"main",autoDeployEnabled:!0,configPath:"unhazzle.yaml"},prEnvironmentSettings:{enabled:!1,autoCreateOnPR:!0,autoDeleteOnMerge:!0,expirationHours:72,nameTemplate:"pr-{number}"},prEnvs:{enabled:!1,maxEnvs:3,lifetimeHours:2,autoDeleteOnPRClose:!0},environments:[d],envCount:1,prEnvCount:0,standardEnvCount:1},m={...e,deployed:!0,project:u};return localStorage.setItem("unhazzle-deployment-state",JSON.stringify(m)),m})},resetState:()=>{s(o),localStorage.removeItem("unhazzle-deployment-state")},removeDatabase:()=>{s(e=>{var t,n,r;let o=(e.containers||[]).map(e=>{var t;if(!(null==(t=e.serviceAccess)?void 0:t.database))return e;let n=(e.environmentVariables||[]).filter(e=>"UNHAZZLE_POSTGRES_URL"!==e.key&&"DATABASE_URL"!==e.key);return{...e,serviceAccess:{...e.serviceAccess,database:!1},environmentVariables:n}}),a=e.resources?{...e.resources,database:void 0}:e.resources,i=e.environment;(null==(t=e.environment)?void 0:t.autoGenerated)&&(i={...e.environment,autoGenerated:e.environment.autoGenerated.filter(e=>"DATABASE_URL"!==e.key)});let s=e.project;(null==(r=e.project)||null==(n=r.environments)?void 0:n[0])&&(s={...e.project,environments:e.project.environments.map((e,t)=>0===t?{...e,containers:o,database:void 0}:e)});let l={...e,containers:o,resources:a,environment:i,project:s};return localStorage.setItem("unhazzle-deployment-state",JSON.stringify(l)),l})},removeCache:()=>{s(e=>{var t,n,r;let o=(e.containers||[]).map(e=>{var t;if(!(null==(t=e.serviceAccess)?void 0:t.cache))return e;let n=(e.environmentVariables||[]).filter(e=>"UNHAZZLE_REDIS_URL"!==e.key&&"REDIS_URL"!==e.key);return{...e,serviceAccess:{...e.serviceAccess,cache:!1},environmentVariables:n}}),a=e.resources?{...e.resources,cache:void 0}:e.resources,i=e.environment;(null==(t=e.environment)?void 0:t.autoGenerated)&&(i={...e.environment,autoGenerated:e.environment.autoGenerated.filter(e=>"REDIS_URL"!==e.key)});let s=e.project;(null==(r=e.project)||null==(n=r.environments)?void 0:n[0])&&(s={...e.project,environments:e.project.environments.map((e,t)=>0===t?{...e,containers:o,cache:void 0}:e)});let l={...e,containers:o,resources:a,environment:i,project:s};return localStorage.setItem("unhazzle-deployment-state",JSON.stringify(l)),l})},updateProject:e=>{s(t=>{if(!t.project)return t;let n={...t.project,...e,updatedAt:new Date().toISOString()},r={...t,project:n};return localStorage.setItem("unhazzle-deployment-state",JSON.stringify(r)),r})},createEnvironment:l,updateEnvironmentConfig:c,deleteEnvironment:e=>{s(t=>{if(!t.project)return t;let n=new Date().toISOString(),r=t.project.environments.map(t=>t.id===e?{...t,status:"deleted"}:t),o=r.filter(e=>"pr"===e.type&&"deleted"!==e.status).length,a=r.filter(e=>"standard"===e.type&&"deleted"!==e.status).length,i={...t.project,environments:r,envCount:o+a,prEnvCount:o,standardEnvCount:a,updatedAt:n},s=t.activeEnvironmentId===e?null:t.activeEnvironmentId,l={...t,project:i,activeEnvironmentId:s};return localStorage.setItem("unhazzle-deployment-state",JSON.stringify(l)),l})},cloneEnvironment:(e,t)=>{if(!i.project)throw Error("Cannot clone environment without a project");let n=i.project.environments.find(t=>t.id===e);if(!n)throw Error("Source environment not found");return l({name:t,type:"standard",containers:JSON.parse(JSON.stringify(n.containers)),database:n.database?JSON.parse(JSON.stringify(n.database)):void 0,cache:n.cache?JSON.parse(JSON.stringify(n.cache)):void 0})},promoteEnvironment:(e,t)=>{if(!i.project)throw Error("Cannot promote without a project");let n=i.project.environments.find(t=>t.id===e),r=i.project.environments.find(e=>e.id===t);if(!n||!r)throw Error("Source or target environment not found");c(t,{containers:JSON.parse(JSON.stringify(n.containers)),database:n.database?JSON.parse(JSON.stringify(n.database)):void 0,cache:n.cache?JSON.parse(JSON.stringify(n.cache)):void 0,status:"provisioning"}),setTimeout(()=>{c(t,{status:"active"})},100)},pauseEnvironment:e=>{s(t=>{if(!t.project)return t;let n=t.project.environments.map(t=>t.id===e&&"active"===t.status?{...t,status:"paused"}:t),r={...t.project,environments:n,updatedAt:new Date().toISOString()},o={...t,project:r};return localStorage.setItem("unhazzle-deployment-state",JSON.stringify(o)),o})},resumeEnvironment:e=>{s(t=>{if(!t.project)return t;let n=t.project.environments.map(t=>t.id===e&&"paused"===t.status?{...t,status:"provisioning"}:t),r={...t.project,environments:n,updatedAt:new Date().toISOString()},o={...t,project:r};return localStorage.setItem("unhazzle-deployment-state",JSON.stringify(o)),setTimeout(()=>{s(t=>{if(!t.project)return t;let n=t.project.environments.map(t=>t.id===e&&"provisioning"===t.status?{...t,status:"active"}:t),r={...t.project,environments:n,updatedAt:new Date().toISOString()},o={...t,project:r};return localStorage.setItem("unhazzle-deployment-state",JSON.stringify(o)),o})},2e3),o})},setActiveEnvironment:e=>{s(t=>{let n={...t,activeEnvironmentId:e};return localStorage.setItem("unhazzle-deployment-state",JSON.stringify(n)),n})},getActiveEnvironment:()=>i.project&&i.activeEnvironmentId&&i.project.environments.find(e=>e.id===i.activeEnvironmentId)||null,createAppsFromImages:(e,t)=>{s(n=>{if(!n.project||!n.project.environments.find(t=>t.id===e))return n;let r=t.map((e,t)=>{var r,o,a,i,s;return{id:"container-".concat(Date.now(),"-").concat(t),name:e.autoName,imageUrl:e.url,registryToken:e.url.startsWith("ghcr.io")?null==(r=n.project)?void 0:r.githubPAT:void 0,port:3e3,healthCheck:{protocol:"HTTP",port:3e3,path:"/health",interval:"30s",timeout:"5s",retries:3},exposure:e.exposure||"private",resources:{cpu:(null==(o=n.recommendations)?void 0:o.cpuPerReplica)||"1 vCPU",memory:(null==(a=n.recommendations)?void 0:a.memoryPerReplica)||"2GB",replicas:{min:(null==(i=n.recommendations)?void 0:i.hpaMin)||2,max:(null==(s=n.recommendations)?void 0:s.hpaMax)||10}},serviceAccess:{database:!1,cache:!1},environmentVariables:[]}}),o=n.project.environments.map(t=>t.id===e?{...t,containers:[...t.containers,...r],publicContainers:[...t.publicContainers,...r.filter(e=>"public"===e.exposure).map(e=>e.name)]}:t),a={...n.project,environments:o,updatedAt:new Date().toISOString()},i={...n,project:a};return localStorage.setItem("unhazzle-deployment-state",JSON.stringify(i)),i})},markEnvironmentChanged:e=>{s(t=>{if(!t.project)return t;let n=t.project.environments.find(t=>t.id===e);if(!n||!n.deployed)return t;let r=t.project.environments.map(t=>t.id===e?{...t,pendingChanges:!0}:t),o={...t.project,environments:r,updatedAt:new Date().toISOString()},a={...t,project:o};return localStorage.setItem("unhazzle-deployment-state",JSON.stringify(a)),a})},deployEnvironment:e=>{s(t=>{if(!t.project)return t;let n=t.project.environments.map(t=>t.id===e?{...t,deployed:!0,deployedAt:new Date().toISOString(),status:"active",pendingChanges:!1}:t),r={...t.project,environments:n,updatedAt:new Date().toISOString()},o={...t,project:r,deployed:!0};return localStorage.setItem("unhazzle-deployment-state",JSON.stringify(o)),o})},applyEnvironmentChanges:e=>{s(t=>{if(!t.project)return t;let n=t.project.environments.map(t=>t.id===e?{...t,pendingChanges:!1,deployedAt:new Date().toISOString()}:t),r={...t.project,environments:n,updatedAt:new Date().toISOString()},o={...t,project:r};return localStorage.setItem("unhazzle-deployment-state",JSON.stringify(o)),o})}},children:a})}function i(){let e=(0,n.useContext)(r);if(void 0===e)throw Error("useDeployment must be used within a DeploymentProvider");return e}},18566,(e,t,n)=>{t.exports=e.r(76562)},11337,e=>{"use strict";e.s(["default",()=>r]);var t=e.i(43476),n=e.i(18566);function r(){return(0,n.useRouter)(),(0,t.jsxs)("div",{className:"fixed top-0 left-0 right-0 bg-gradient-to-r from-purple-600 to-purple-800 text-white py-3 px-4 flex items-center justify-center gap-4 text-sm font-medium z-50 shadow-lg",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("span",{className:"mr-2",children:"ðŸŽ¬"}),(0,t.jsx)("strong",{children:"Demo Mode:"}),"Â Experience unhazzle with a sample e-commerce application"]}),(0,t.jsx)("button",{onClick:()=>{confirm("Are you sure you want to clear all data and reset the demo?")&&(localStorage.clear(),window.location.href="/unhazzle.io/demo")},className:"px-3 py-1 bg-white/20 hover:bg-white/30 rounded text-xs transition border border-white/30",title:"Clear local storage and restart",children:"Reset Demo"})]})}}]);